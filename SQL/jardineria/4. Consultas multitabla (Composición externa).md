#  Consultas Multitabla con Composici贸n Externa

Este documento presenta una colecci贸n de consultas SQL que utilizan **composici贸n externa** para explorar relaciones entre m煤ltiples tablas del modelo relacional de Jardiner铆a. El enfoque est谩 en aplicar cl谩usulas como `LEFT JOIN`, `RIGHT JOIN` y `FULL OUTER JOIN` (cuando sea compatible) para identificar registros que no tienen correspondencia directa entre entidades.

##  驴Qu茅 contiene este archivo?

El archivo incluye consultas que permiten:

- Detectar clientes sin pagos o pedidos.
- Identificar empleados sin oficina o sin clientes asignados.
- Localizar productos que nunca han sido vendidos.
- Analizar relaciones jer谩rquicas entre empleados y jefes.
- Estudiar oficinas sin actividad comercial en ciertas gamas de producto.

Cada consulta est谩 numerada y estructurada con su c贸digo SQL, lista para ser ejecutada en entornos compatibles con MySQL o PostgreSQL.

## З Contexto del modelo

Las consultas se basan en el modelo relacional de la base de datos **Jardiner铆a**, que incluye las siguientes entidades:

- `cliente`: informaci贸n de clientes y sus representantes.
- `empleado`: datos de empleados, jefes y oficinas.
- `oficina`: ubicaci贸n y contacto de las oficinas.
- `pago`: transacciones realizadas por los clientes.
- `pedido` y `detalle_pedido`: pedidos realizados y sus productos.
- `producto` y `gama_producto`: cat谩logo de productos y sus gamas.

Este modelo permite realizar an谩lisis detallados sobre la cobertura comercial, la eficiencia operativa y la estructura organizacional.

##  Prop贸sito del ejercicio

El prop贸sito de este archivo es:

- Aplicar t茅cnicas de composici贸n externa para detectar ausencias o relaciones incompletas.
- Explorar c贸mo se comportan las entidades cuando no hay correspondencia directa.
- Preparar material t茅cnico para documentaci贸n, evaluaci贸n y visualizaci贸n en Power BI.
- Consolidar buenas pr谩cticas en SQL para portafolios profesionales.




## Ejemplos

1. Devuelve un listado que muestre solamente los clientes que no han realizado ning煤n pago.
```sql
SELECT c.nombre_cliente
FROM cliente c
LEFT JOIN pago p ON c.codigo_cliente = p.codigo_cliente
WHERE p.codigo_cliente IS NULL;
```
<p align="center">
<img src="./imagenes/externa 1.png" alt="consulta externa 1" width="200"/>


2. Devuelve un listado que muestre solamente los clientes que no han realizado ning煤n pedido.
```sql
SELECT c.nombre_cliente
FROM cliente c
LEFT JOIN pedido p ON c.codigo_cliente = p.codigo_cliente
WHERE p.codigo_cliente IS NULL;
```
<p align="center">
<img src="./imagenes/externa 2.png" alt="consulta externa 2" width="200"/>
  
3. Devuelve un listado que muestre los clientes que no han realizado ning煤n pago y los que no han realizado ning煤n pedido.
```sql
SELECT c.nombre_cliente
FROM cliente c
LEFT JOIN pago p ON c.codigo_cliente = p.codigo_cliente
LEFT JOIN pedido pd ON c.codigo_cliente = pd.codigo_cliente
WHERE p.codigo_cliente IS NULL AND pd.codigo_cliente IS NULL;
```
<p align="center">
<img src="./imagenes/externa 3.png" alt="consulta externa 3" width="200"/>
  
4. Devuelve un listado que muestre solamente los empleados que no tienen una oficina asociada.
```sql
SELECT e.nombre, e.apellido1
FROM empleado e
LEFT JOIN oficina o ON e.codigo_oficina = o.codigo_oficina
WHERE o.codigo_oficina IS NULL;
```
<p align="center">
<img src="./imagenes/externa 4.png" alt="consulta externa 4" width="200"/>
  
5. Devuelve un listado que muestre solamente los empleados que no tienen un cliente asociado.
```sql
SELECT e.nombre, e.apellido1
FROM empleado e
LEFT JOIN cliente c ON e.codigo_empleado = c.codigo_empleado_rep_ventas
WHERE c.codigo_empleado_rep_ventas IS NULL;
```
<p align="center">
<img src="./imagenes/externa 5.png" alt="consulta externa 5" width="200"/>
  
6. Devuelve un listado que muestre solamente los empleados que no tienen un cliente asociado junto con los datos de la oficina donde trabajan.
```sql
SELECT e.nombre, e.apellido1, o.ciudad, o.telefono
FROM empleado e
LEFT JOIN cliente c ON e.codigo_empleado = c.codigo_empleado_rep_ventas
JOIN oficina o ON e.codigo_oficina = o.codigo_oficina
WHERE c.codigo_empleado_rep_ventas IS NULL;
```
<p align="center">
<img src="./imagenes/externa 6.png" alt="consulta externa 6" width="300"/>
  
7. Devuelve un listado que muestre los empleados que no tienen una oficina asociada y los que no tienen un cliente asociado.
```sql
SELECT e.nombre, e.apellido1
FROM empleado e
LEFT JOIN oficina o ON e.codigo_oficina = o.codigo_oficina
LEFT JOIN cliente c ON e.codigo_empleado = c.codigo_empleado_rep_ventas
WHERE o.codigo_oficina IS NULL OR c.codigo_empleado_rep_ventas IS NULL;
```
<p align="center">
<img src="./imagenes/externa 7.png" alt="consulta externa 7" width="200"/>
  
8. Devuelve un listado de los productos que nunca han aparecido en un pedido.
```sql
SELECT p.nombre
FROM producto p
LEFT JOIN detalle_pedido dp ON p.codigo_producto = dp.codigo_producto
WHERE dp.codigo_producto IS NULL;
```
<p align="center">
<img src="./imagenes/externa 8.png" alt="consulta externa 8" width="300"/>
  
9. Devuelve un listado de los productos que nunca han aparecido en un pedido. El resultado debe mostrar el nombre, la descripci贸n y la imagen del producto.
```sql
SELECT p.nombre, p.descripcion, gp.imagen
FROM producto p
LEFT JOIN detalle_pedido dp ON p.codigo_producto = dp.codigo_producto
JOIN gama_producto gp ON p.gama = gp.gama
WHERE dp.codigo_producto IS NULL;
```
<p align="center">
<img src="./imagenes/externa 9.png" alt="consulta externa 9" width="500"/>
  
10. Devuelve las oficinas donde no trabajan ninguno de los empleados que hayan sido los representantes de ventas de alg煤n cliente que haya realizado la compra de alg煤n producto de la gama Frutales.
```sql
SELECT o.codigo_oficina, o.ciudad
FROM oficina o
LEFT JOIN empleado e ON o.codigo_oficina = e.codigo_oficina
WHERE o.codigo_oficina NOT IN (
    SELECT DISTINCT e.codigo_oficina
    FROM empleado e
    JOIN cliente c ON e.codigo_empleado = c.codigo_empleado_rep_ventas
    JOIN pedido p ON c.codigo_cliente = p.codigo_cliente
    JOIN detalle_pedido dp ON p.codigo_pedido = dp.codigo_pedido
    JOIN producto pr ON dp.codigo_producto = pr.codigo_producto
    WHERE pr.gama = 'Frutales'
);
```
<p align="center">
<img src="./imagenes/externa 10.png" alt="consulta externa 10" width="200"/>
  
11. Devuelve un listado con los clientes que han realizado alg煤n pedido pero no han realizado ning煤n pago.
```sql
SELECT c.nombre_cliente
FROM cliente c
LEFT JOIN pedido pd ON c.codigo_cliente = pd.codigo_cliente
LEFT JOIN pago p ON c.codigo_cliente = p.codigo_cliente
WHERE pd.codigo_cliente IS NOT NULL AND p.codigo_cliente IS NULL;
```
<p align="center">
<img src="./imagenes/externa 11.png" alt="consulta externa 11" width="200"/>
  
12. Devuelve un listado con los datos de los empleados que no tienen clientes asociados y el nombre de su jefe asociado.
```sql
SELECT e.nombre, e.apellido1, j.nombre AS jefe_nombre, j.apellido1 AS jefe_apellido
FROM empleado e
LEFT JOIN cliente c ON e.codigo_empleado = c.codigo_empleado_rep_ventas
LEFT JOIN empleado j ON e.codigo_jefe = j.codigo_empleado
WHERE c.codigo_empleado_rep_ventas IS NULL;
```
<p align="center">
<img src="./imagenes/externa 12.png" alt="consulta externa 12" width="300"/>
  
